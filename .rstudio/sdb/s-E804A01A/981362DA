{
    "contents" : "library(data.table)\n\n\n\n\nexpirations <- getExpirations(con)\n\nfor (i in 2005:2015) {\n  \n  dt.spy <- data.table(dbGetQuery(conn = con,statement = paste0(\"select * from import_livevol.spy \n                                                                where vwap > 0 and year(expiration) = \",i,\" and expiration in (\", \n                                                                paste(\"'\",as.character(expirations$expiration),\"'\",\n                                                                      collapse=\", \",sep=\"\"), \") \"  )))\n  \n  \n  dt.spy <- organizeData(dt.spy)\n  cacheObject(mxt.data = dt.spy, chr.location= 'spy_options/', chr.name = paste0('spy_',i))\n  \n}\n\n\n\n\ndt.spy <- organizeData(dt.spy)\n\n\n\n\n\n\n\n\ngetBestOption(data=dt.spy,chr.trade_date = '2014-01-02',chr.expiration =  '2015-01-17',chr.option_type =  'p', int.min_delta = .3)\n\n\n\noptVertical(data = under2, chr.trade_date = '2014-01-02', chr.expiration = '2015-01-17', chr.option_type = 'c',chr.long_short = 'short',vec.deltas = c(.15,.3),int.qty=1)\n    \n\n\ngetBestOption(data=under2,chr.trade_date = '2014-01-02',chr.expiration =  '2014-01-18',chr.option_type =  'c', int.min_delta = .15 )\n\n\n\n\n\ntradeking <- data.table(dbGetQuery(con,\"select * from tradeking.spy\"))\ntradeking2 <- tradeking[expiration=='2015-11-20'][,list(quote_date,expiration,strike,option_type,underlying_tradeking=underlying_ask,bid_tradeking=bid,ask_tradeking=ask, delta_tradeking=delta)]\n\n\nlivevol <- data.table(dbGetQuery(con, \"select * from import_livevol.spy where quote_date >= 20151105\"))\nlivevol2 <- livevol[expiration=='2015-11-20'][,list(quote_date, expiration, strike, option_type, underlying_livevol=underlying_ask_1545, bid_livevol=bid_1545, ask_livevol=ask_1545,delta_livevol=delta_1545)]\n\n\n\n\nalls <- merge(tradeking2, livevol2, by=c('quote_date','expiration','strike','option_type'))\n\nggplot(alls, aes(x=bid_tradeking, y=bid_livevol)) + geom_point() + geom_abline(slope=1)\n\n\n\n\n\n\n",
    "created" : 1448326833261.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1215715316",
    "id" : "981362DA",
    "lastKnownWriteTime" : 1448326844,
    "path" : "~/analysis/functions.R",
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled6"
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "type" : "r_source"
}